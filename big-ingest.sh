MONGO_VERSION=3.6
NETWORK_NAME="primary_net"

MONGOS1_SRC="mongos1"
MONGOS1_PORT=27017
DATABASE="test_db"
COLLECTION="test_col"

echo "simulating 10 ingestions from 10 different sources" && \
for i in $(seq 10); do
	echo $i
	docker run -d --rm --network $NETWORK_NAME mongo:$MONGO_VERSION mongo --host "$MONGOS1_SRC:$MONGOS1_PORT" $DATABASE --eval "
		db.$COLLECTION.insertMany([
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 },
			{ item_id: $i, count: 1 }
		])
	" &
done && \

echo "--------------------------------------------------" && \
docker run -it --rm --network $NETWORK_NAME mongo:$MONGO_VERSION mongo --host "$MONGOS1_SRC:$MONGOS1_PORT" $DATABASE --eval "
	db.$COLLECTION.getShardDistribution()
" &&

echo "--------------------------------------------------" && \
echo "done."
